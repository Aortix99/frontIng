<!-- 
  Template de Register - Dise√±o responsivo y accesible
  Aplica principios UX y accesibilidad:
  - Formulario sem√°ntico con validaciones detalladas
  - Estados de carga y error claros
  - Dise√±o responsive y moderno
-->

<div class="register-container">
  <div class="register-card">
    <!-- Header -->
    <div class="register-header">
      <div class="logo">
        <h1 class="app-title">Ing Civil</h1>
        <p class="app-subtitle">Crear Nueva Cuenta</p>
      </div>
    </div>

    <!-- Formulario de Registro -->
    <div class="register-form-container">
      <h2 class="form-title">Registro de Usuario</h2>
      
      <!-- Mensaje de error global -->
      <div class="error-message" *ngIf="hasError" role="alert">
        <i class="error-icon">‚ö†Ô∏è</i>
        <span>{{ errorMessage }}</span>
      </div>

      <!-- Formulario -->
      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form" novalidate>
        
        <!-- Campo Nombre -->
        <div class="form-group">
          <label for="name" class="form-label">
            Nombre Completo <span class="required">*</span>
          </label>
          <div class="input-container">
            <input
              id="name"
              type="text"
              formControlName="name"
              class="form-input"
              [class.error]="name?.invalid && name?.touched"
              placeholder="Juan P√©rez"
              autocomplete="name"
              [disabled]="isLoading"
            />
            <i class="input-icon">üë§</i>
          </div>
          <div class="field-error" *ngIf="name?.invalid && name?.touched">
            {{ getFieldError('name') }}
          </div>
        </div>

        <!-- Campo Email -->
        <div class="form-group">
          <label for="email" class="form-label">
            Correo Electr√≥nico <span class="required">*</span>
          </label>
          <div class="input-container">
            <input
              id="email"
              type="email"
              formControlName="email"
              class="form-input"
              [class.error]="email?.invalid && email?.touched"
              placeholder="juan@ejemplo.com"
              autocomplete="email"
              [disabled]="isLoading"
            />
            <i class="input-icon">üìß</i>
          </div>
          <div class="field-error" *ngIf="email?.invalid && email?.touched">
            {{ getFieldError('email') }}
          </div>
        </div>

        <!-- Campo Contrase√±a -->
        <div class="form-group">
          <label for="password" class="form-label">
            Contrase√±a <span class="required">*</span>
          </label>
          <div class="input-container">
            <input
              id="password"
              [type]="showPassword ? 'text' : 'password'"
              formControlName="password"
              class="form-input password-input"
              [class.error]="password?.invalid && password?.touched"
              placeholder="M√≠nimo 8 caracteres"
              autocomplete="new-password"
              [disabled]="isLoading"
            />
            <button
              type="button"
              class="password-toggle"
              (click)="togglePasswordVisibility()"
              [attr.aria-label]="showPassword ? 'Ocultar contrase√±a' : 'Mostrar contrase√±a'"
            >
              <i [class]="showPassword ? 'icon-eye-off' : 'icon-eye'">
                {{ showPassword ? 'üôà' : 'üëÅÔ∏è' }}
              </i>
            </button>
          </div>
          
          <!-- Indicador de fortaleza de contrase√±a -->
          <div class="password-strength" *ngIf="password?.value">
            <div class="strength-bar">
              <div 
                class="strength-fill" 
                [class]="getPasswordStrengthClass()"
                [style.width.%]="getPasswordStrengthPercentage()"
              ></div>
            </div>
            <div class="strength-text">
              Fortaleza: <span [class]="getPasswordStrengthClass()">{{ getPasswordStrengthText() }}</span>
            </div>
          </div>

          <div class="field-error" *ngIf="password?.invalid && password?.touched">
            {{ getFieldError('password') }}
          </div>
        </div>

        <!-- Campo Confirmar Contrase√±a -->
        <div class="form-group">
          <label for="confirmPassword" class="form-label">
            Confirmar Contrase√±a <span class="required">*</span>
          </label>
          <div class="input-container">
            <input
              id="confirmPassword"
              [type]="showConfirmPassword ? 'text' : 'password'"
              formControlName="confirmPassword"
              class="form-input password-input"
              [class.error]="confirmPassword?.invalid && confirmPassword?.touched"
              placeholder="Repetir contrase√±a"
              autocomplete="new-password"
              [disabled]="isLoading"
            />
            <button
              type="button"
              class="password-toggle"
              (click)="toggleConfirmPasswordVisibility()"
              [attr.aria-label]="showConfirmPassword ? 'Ocultar contrase√±a' : 'Mostrar contrase√±a'"
            >
              <i [class]="showConfirmPassword ? 'icon-eye-off' : 'icon-eye'">
                {{ showConfirmPassword ? 'üôà' : 'üëÅÔ∏è' }}
              </i>
            </button>
          </div>
          <div class="field-error" *ngIf="confirmPassword?.invalid && confirmPassword?.touched">
            {{ getFieldError('confirmPassword') }}
          </div>
        </div>

        <!-- Checkbox T√©rminos y Condiciones -->
        <div class="form-group checkbox-group">
          <label class="checkbox-label">
            <input
              type="checkbox"
              formControlName="acceptTerms"
              class="checkbox-input"
              [disabled]="isLoading"
            />
            <span class="checkbox-custom"></span>
            <span class="checkbox-text">
              Acepto los 
              <a href="#" class="terms-link" (click)="$event.preventDefault(); openTerms()">
                t√©rminos y condiciones
              </a> 
              y la 
              <a href="#" class="terms-link" (click)="$event.preventDefault(); openPrivacy()">
                pol√≠tica de privacidad
              </a>
              <span class="required">*</span>
            </span>
          </label>
          <div class="field-error" *ngIf="acceptTerms?.invalid && acceptTerms?.touched">
            Debes aceptar los t√©rminos y condiciones
          </div>
        </div>

        <!-- Checkbox Newsletter -->
        <div class="form-group checkbox-group">
          <label class="checkbox-label">
            <input
              type="checkbox"
              formControlName="newsletter"
              class="checkbox-input"
              [disabled]="isLoading"
            />
            <span class="checkbox-custom"></span>
            <span class="checkbox-text">
              Deseo recibir notificaciones sobre actualizaciones del sistema
            </span>
          </label>
        </div>

        <!-- Bot√≥n de Registro -->
        <button
          type="submit"
          class="register-button"
          [disabled]="registerForm.invalid || isLoading"
          [class.loading]="isLoading"
        >
          <span *ngIf="!isLoading">Crear Cuenta</span>
          <span *ngIf="isLoading" class="loading-content">
            <i class="spinner"></i>
            Creando cuenta...
          </span>
        </button>

      </form>

      <!-- Separador -->
      <div class="divider">
        <span>¬øYa tienes cuenta?</span>
      </div>

      <!-- Bot√≥n de Login -->
      <button
        type="button"
        class="login-button"
        (click)="goToLogin()"
        [disabled]="isLoading"
      >
        Iniciar Sesi√≥n
      </button>

    </div>

    <!-- Footer -->
    <div class="register-footer">
      <p class="footer-text">
        ¬© 2025 Ing Civil. Registro seguro con encriptaci√≥n SSL.
      </p>
    </div>

  </div>
</div>