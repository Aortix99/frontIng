<!-- 
  Template de Login - DiseÃ±o responsivo y accesible
  Aplica principios UX y accesibilidad:
  - Formulario semÃ¡ntico con labels apropiados
  - Estados de carga y error claros
  - DiseÃ±o responsive y moderno
-->

<div class="login-container">
  <div class="login-card">
    <!-- Header -->
    <div class="login-header">
      <div class="logo">
        <h1 class="app-title">Ing Civil</h1>
        <p class="app-subtitle">Sistema de CÃ¡lculos Estructurales</p>
      </div>
    </div>

    <!-- Formulario de Login -->
    <div class="login-form-container">
      <h2 class="form-title">Iniciar SesiÃ³n</h2>
      
      <!-- Mensaje de error global -->
      <div class="error-message" *ngIf="hasError" role="alert">
        <i class="error-icon">âš ï¸</i>
        <span>{{ errorMessage }}</span>
      </div>

      <!-- Formulario -->
      <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="login-form" novalidate>
        
        <!-- Campo Email -->
        <div class="form-group">
          <label for="email" class="form-label">
            Email <span class="required">*</span>
          </label>
          <div class="input-container">
            <input
              id="email"
              type="email"
              formControlName="email"
              class="form-input"
              [class.error]="email?.invalid && email?.touched"
              placeholder="tu@email.com"
              autocomplete="email"
              [disabled]="isLoading"
            />
            <i class="input-icon">ğŸ“§</i>
          </div>
          <div class="field-error" *ngIf="email?.invalid && email?.touched">
            {{ getFieldError('email') }}
          </div>
        </div>

        <!-- Campo ContraseÃ±a -->
        <div class="form-group">
          <label for="password" class="form-label">
            ContraseÃ±a <span class="required">*</span>
          </label>
          <div class="input-container">
            <input
              id="password"
              [type]="showPassword ? 'text' : 'password'"
              formControlName="password"
              class="form-input"
              [class.error]="password?.invalid && password?.touched"
              placeholder="Tu contraseÃ±a"
              autocomplete="current-password"
              [disabled]="isLoading"
            />
            <button
              type="button"
              class="password-toggle"
              (click)="togglePasswordVisibility()"
              [disabled]="isLoading"
              [attr.aria-label]="showPassword ? 'Ocultar contraseÃ±a' : 'Mostrar contraseÃ±a'"
            >
              <i>{{ showPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸' }}</i>
            </button>
          </div>
          <div class="field-error" *ngIf="password?.invalid && password?.touched">
            {{ getFieldError('password') }}
          </div>
        </div>

        <!-- Recordarme -->
        <div class="form-group checkbox-group">
          <label class="checkbox-label">
            <input
              type="checkbox"
              formControlName="rememberMe"
              class="checkbox"
              [disabled]="isLoading"
            />
            <span class="checkbox-custom"></span>
            Recordarme
          </label>
        </div>

        <!-- BotÃ³n de Login -->
        <button
          type="submit"
          class="login-button"
          [disabled]="loginForm.invalid || isLoading"
          [class.loading]="isLoading"
        >
          <span *ngIf="!isLoading">Iniciar SesiÃ³n</span>
          <span *ngIf="isLoading" class="loading-content">
            <i class="spinner"></i>
            Iniciando sesiÃ³n...
          </span>
        </button>

        <!-- Enlaces adicionales -->
        <div class="form-links">
          <button
            type="button"
            class="link-button"
            (click)="goToForgotPassword()"
            [disabled]="isLoading"
          >
            Â¿Olvidaste tu contraseÃ±a?
          </button>
        </div>

      </form>

      <!-- Separador -->
      <div class="divider">
        <span>Â¿No tienes cuenta?</span>
      </div>

      <!-- BotÃ³n de Registro -->
      <!-- <button
        type="button"
        class="register-button"
        (click)="goToRegister()"
        [disabled]="isLoading"
      >
        Crear cuenta nueva
      </button> -->

    </div>

    <!-- Footer -->
    <div class="login-footer">
      <p class="footer-text">
        Â© 2025 Ing Civil. Sistema seguro con encriptaciÃ³n SSL.
      </p>
    </div>

  </div>
</div>